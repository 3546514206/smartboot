import{_ as f,q as _,e as p,i as v,o as y,s as h,n as e,t as c,v as u,p as m}from"./index-6b451810.js";import{a as w,b,c as x,d as N}from"./api-c953154a.js";import{e as k}from"./editor.api-c30b8609.js";import"./toggleHighContrast-59927427.js";import"./monaco.contribution-7418d8b9.js";import{_ as C}from"./blank-48692729.js";import"./preload-helper-41c905a7.js";var s;const L={mounted(){this.init()},methods:{init(){s=k.create(this.$refs.editor,{theme:"vs-dark",value:`<?xml version="1.0" encoding="UTF-8"?>
<engines xmlns="http://org.smartboot/smart-flow"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://org.smartboot/smart-flow
                             http://org.smartboot/smart-flow-1.0.1.xsd">





</engines>`,language:"xml",folding:!0,foldingHighlight:!0,foldingStrategy:"indentation",showFoldingControls:"always",disableLayerHinting:!0,emptySelectionClipboard:!1,selectionClipboard:!1,automaticLayout:!0,codeLens:!1,suggestFontSize:14,fontSize:14,scrollBeyondLastLine:!1,colorDecorators:!0,accessibilitySupport:"auto",lineNumbers:"on",lineNumbersMinChars:5,readOnly:!1})}},setup(){const r=_();let t=-1,l=window.location.href;if(l.split("/").length>1){let i=l.split("/");i.length>0&&!isNaN(parseFloat(i[i.length-1]))&&(t=i[i.length-1])}const n=p({id:t,engineName:""});return v(()=>{t>-1&&(async()=>{const{data:o}=await w(t);n.value.engineName=o.engineName,s.setValue(o.content)})()}),{engineInfo:n,validate:function(){const i=s.getValue();(async()=>{const a=await b(i);if(!a.success)return;n.value.engineName=a.data;const d=await x(i);let g="data:image/png;base64,"+window.btoa(String.fromCharCode(...new Uint8Array(d.data)));document.getElementById("img_view").src=g})()},save(){const i=s.getValue(),o={id:n.value.id,engineName:n.value.engineName,content:i};(async()=>{(await N(o)).success&&r.push({path:"/engines"})})()}}}},S={class:"box"},V={class:"engine_edit_form"},I={class:"layui-form-item",hidden:""},q={class:"layui-form-item"},B=e("label",{class:"layui-form-label"},[m("引擎名称"),e("span",{class:"layui-required layui-icon"},"*")],-1),E={class:"layui-input-block",style:{width:"30%"}},F={class:"layui-form-item layui-form-text"},M=e("label",{class:"layui-form-label"},[m("编排内容"),e("span",{class:"layui-required layui-icon"},"*")],-1),U={class:"layui-input-block layout-edit-line"},T={class:"layout-editor",id:"editor",ref:"editor"},z=e("div",{class:"layout-preview engine_img_view"},[e("img",{class:"layout-preview-image",src:C,id:"img_view"})],-1),D={class:"layui-form-item"},H={class:"layui-input-block"};function j(r,t,l,n,i,o){return y(),h("div",S,[e("div",V,[e("div",I,[c(e("input",{type:"text",name:"title","onUpdate:modelValue":t[0]||(t[0]=a=>n.engineInfo.id=a),autocomplete:"off",class:"layui-input",hidden:""},null,512),[[u,n.engineInfo.id]])]),e("div",q,[B,e("div",E,[c(e("input",{type:"text",name:"title","onUpdate:modelValue":t[1]||(t[1]=a=>n.engineInfo.engineName=a),required:"","lay-verify":"required",placeholder:"请输入名称",autocomplete:"off",class:"layui-input"},null,512),[[u,n.engineInfo.engineName]])])]),e("div",F,[M,e("div",U,[e("div",T,null,512),z])]),e("div",D,[e("div",H,[e("button",{class:"layui-btn",onClick:t[2]||(t[2]=a=>n.validate()),click:"javascript:void(0)"},"验证"),e("button",{class:"layui-btn",onClick:t[3]||(t[3]=a=>n.save())},"保存")])])])])}const K=f(L,[["render",j]]);export{K as default};
