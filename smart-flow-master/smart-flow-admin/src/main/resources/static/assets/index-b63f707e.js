import{_ as F,e as x,i as H,I as z,J as E,O as G,G as O,x as Q,j as L,r as R,o as a,s as d,n as e,m as r,l as m,F as S,y as J,B as C,p as g,t as w,v as A,z as I,A as y,a as T}from"./index-6b451810.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{G as W}from"./index-de2b558d.js";import{p as K,q as P}from"./api-c953154a.js";import"./preload-helper-41c905a7.js";const Y={setup(){const b={nodes:[],edges:[]},o=x(!1),N=x({}),t=x({}),h=x({versions:{},hosts:{}}),p=x({engineName:"",host:"-1",md5:""}),_=x([]),c=x([]),k=x([]),M=[{title:"名称",width:"30px",key:"name",customSlot:"name"},{title:"值",width:"120px",key:"value"}];let U=window.innerWidth*.8,B=window.innerHeight*.8,V=window.outerWidth*.5-window.outerWidth*.5*.15;const q={a:"https://gw.alipayobjects.com/mdn/rms_8fd2eb/afts/img/A*0HC-SawWYUoAAAAAAAAAAABkARQnAQ",b:"https://gw.alipayobjects.com/mdn/rms_8fd2eb/afts/img/A*sxK0RJ1UhNkAAAAAAAAAAABkARQnAQ"};W.registerNode("card-node",{drawShape:function(n,u){const v=n.customStyle.color,f=2,s=u.addShape("rect",{attrs:{x:-100,y:0,width:200,height:60,stroke:v,radius:f},name:"main-box",draggable:!0});return u.addShape("rect",{attrs:{x:0-100,y:0,width:200,height:20,fill:v,radius:[f,f,0,0]},name:"title-box",draggable:!0}),u.addShape("image",{attrs:{x:-96,y:2,height:16,width:16,cursor:"pointer",img:q[n.nodeType||"app"]},name:"node-icon"}),u.addShape("text",{attrs:{textBaseline:"top",y:2,x:-76,lineHeight:20,text:n.title,fill:"#fff"},name:"title"}),n.panels.forEach((j,D)=>{u.addShape("text",{attrs:{textBaseline:"top",y:25,x:24+D*60-100,lineHeight:20,text:j.title,fill:"rgba(0,0,0, 0.4)"},name:`index-title-${D}`}),u.addShape("text",{attrs:{textBaseline:"top",y:42,x:24+D*60-100,lineHeight:20,text:j.value,fill:"#595959"},name:`index-value-${D}`})}),s}},"single-node");let l;return H(()=>{l=new W.Graph({container:"engine_pic",width:U,height:B,fitCenter:!1,groupByTypes:!0,groupType:"combo",modes:{default:["click-select","activate-relations"]},defaultEdge:{type:"line",style:{lineWidth:1,stroke:"#9900ff",endArrow:{path:"M 0,0 L 10,3 L 10,-3 Z",fill:"#9900ff",strokeOpacity:.8,fillOpacity:.8}}},defaultNode:{type:"card-node"},defaultCombo:{padding:30,type:"rect",labelCfg:{position:"top"},style:{stroke:"grey",lineDash:10}}}),l.data(b),l.render(),l.on("node:click",n=>{const u=n.item;let v=u.getModel().componentInfo,f=u.getModel().id;f==="#start"||f==="#end"||(o.value=!o.value,N.value=v,t.value=u.getModel().customData)}),l.on("combo:click",n=>{const u=n.item;let v=u.getModel().componentInfo;o.value=!o.value,N.value=v,t.value=u.getModel().customData}),(async()=>{const{data:n}=await K();_.value=n.engines,h.value.versions=n.versions,h.value.hosts=n.hosts,_.value.length>0&&(p.value.engineName=_.value[0],c.value=h.value.versions[p.value.engineName],c.value&&c.value.length>0&&(p.value.md5=c.value[0],k.value=h.value.hosts[p.value.md5]))})()}),{componentInfoVisible:o,componentInfo:N,customData:t,columns2:M,info:h,query:p,engine_list:_,version_list:c,host_list:k,select_changed(){(async()=>{const n=await P(p.value);h.value=n.data,b.edges=n.data.edges,b.combos=n.data.combos;const u=window.innerWidth*.8;let v=0,f=0;for(let s=0;s<n.data.nodes.length;s++)n.data.nodes[s].x=V+n.data.nodes[s].x*300,n.data.nodes[s].y=n.data.nodes[s].y*150+90,v=Math.max(v,Math.abs(n.data.nodes[s].x)),f=Math.max(f,Math.abs(n.data.nodes[s].y)),n.data.nodes[s].nodeType="a",(n.data.nodes[s].id==="#start"||n.data.nodes[s].id==="#end")&&(n.data.nodes[s].style.width=200,n.data.nodes[s].style.height=50,n.data.nodes[s].style.fill="rgba(0,204,0,0.5)",n.data.nodes[s].style.radius=[2,2,0,0]);b.nodes=n.data.nodes,l.data(b),l.changeSize(u,f+100),l.render()})()},select_changed_list(i){i===1?(_.value.length>0&&(c.value=h.value.versions[p.value.engineName]),c.value&&c.value.length>0&&(p.value.md5=c.value[0])):i===2&&c.value&&c.value.length>0&&(k.value=h.value.hosts[p.value.md5],p.value.host="-1")}}}},Z={id:"tool-bar",style:{height:"50px",display:"flex",position:"absolute",width:"85%","background-color":"white","align-items":"center",border:"0 solid #c7bfbf","border-bottom-width":"0.5px"}},X=e("label",{class:"layui-form-label line-label"},[e("span",{class:"layui-required layui-icon"},"*"),g("引擎")],-1),$={class:"layui-input-block"},ee=e("label",{class:"layui-form-label line-label"},[e("span",{class:"layui-required layui-icon"},"*"),g("版本")],-1),te={class:"layui-input-block"},le=e("label",{class:"layui-form-label line-label"},"主机",-1),oe={class:"layui-input-block"},ne={style:{"margin-left":"10px"}},ae=e("div",{id:"engine_pic"},null,-1),ie=e("h3",{style:{"padding-left":"20px"}},"基本信息",-1),se={class:"layui-form-item line-item"},de=e("label",{class:"layui-form-label line-label"},"组件名称",-1),ce={class:"layui-input-block line-block"},ue={class:"layui-form-item"},re=e("label",{class:"layui-form-label line-label"},"组件描述",-1),me={class:"layui-input-block line-block"},pe={class:"layui-form-item"},_e=e("label",{class:"layui-form-label line-label"},"组件类型",-1),fe={class:"layui-input-block line-block"},ye={key:0,class:"layui-form-item"},be=e("label",{class:"layui-form-label line-label"},"属性列表",-1),he={class:"layui-input-block line-block"},ve=e("i",{class:"layui-icon layui-icon-about",style:{color:"#1E9FFF"}},null,-1),ge=[ve],ke={key:1,class:"layui-form-item"},xe=e("label",{class:"layui-form-label line-label"},"扩展属性",-1),we={class:"layui-input-block line-block"},Ae={key:2,style:{"padding-left":"20px"}},Ie={key:3,class:"layui-form-item"},Ve=e("label",{class:"layui-form-label line-label"},"脚本名称",-1),Se={class:"layui-input-block line-block"},Ne={key:4,class:"layui-form-item"},De={class:"layui-input-block line-block"},Ce={key:5,class:"layui-form-item"},Me=e("label",{class:"layui-form-label line-label"},"回滚脚本",-1),Ue={class:"layui-input-block line-block"},Be={key:6,class:"layui-form-item"},qe={class:"layui-input-block line-block"},Te=e("h3",{style:{"padding-left":"20px"}},"运行信息",-1),je={key:7,class:"layui-form-item"},We=e("label",{class:"layui-form-label line-label"},"统计开始",-1),Fe={class:"layui-input-block line-block"},He={key:8,class:"layui-form-item"},ze=e("label",{class:"layui-form-label line-label"},"统计信息",-1),Ee={class:"layui-input-block line-block excute-block"},Ge={key:0,class:"excute-text"},Oe=["textContent"],Qe=["textContent"],Le=e("br",null,null,-1);function Re(b,o,N,t,h,p){const _=z,c=E,k=G,M=O,U=Q,B=L,V=R("highlightjs"),q=J;return a(),d(S,null,[e("div",Z,[e("div",null,[r(k,{sm:"6",md:"6"},{default:m(()=>[X,e("div",$,[r(c,{modelValue:t.query.engineName,"onUpdate:modelValue":o[0]||(o[0]=l=>t.query.engineName=l),onChange:o[1]||(o[1]=l=>t.select_changed_list(1)),style:{border:"0.5px solid #c7bfbf"}},{default:m(()=>[(a(!0),d(S,null,C(t.engine_list,(l,i)=>(a(),T(_,{key:i,value:l},{default:m(()=>[g(I(l),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),e("div",null,[r(k,{sm:"6",md:"6"},{default:m(()=>[ee,e("div",te,[r(c,{modelValue:t.query.md5,"onUpdate:modelValue":o[2]||(o[2]=l=>t.query.md5=l),onChange:o[3]||(o[3]=l=>t.select_changed_list(2)),style:{border:"0.5px solid #c7bfbf"}},{default:m(()=>[(a(!0),d(S,null,C(t.version_list,(l,i)=>(a(),T(_,{key:i,value:l},{default:m(()=>[g(I(l),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),e("div",null,[r(k,{sm:"6",md:"6"},{default:m(()=>[le,e("div",oe,[r(c,{modelValue:t.query.host,"onUpdate:modelValue":o[4]||(o[4]=l=>t.query.host=l),style:{border:"0.5px solid #c7bfbf"}},{default:m(()=>[r(_,{key:"-1",value:"-1"},{default:m(()=>[g("-- 所有主机 --")]),_:1}),(a(!0),d(S,null,C(t.host_list,(l,i)=>(a(),T(_,{key:i,value:l},{default:m(()=>[g(I(l),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),e("div",ne,[r(k,{sm:"6",md:"6"},{default:m(()=>[r(M,{"prefix-icon":"layui-icon-search",onClick:o[5]||(o[5]=l=>t.select_changed())},{default:m(()=>[g("搜索")]),_:1})]),_:1})])]),ae,r(q,{type:"drawer",modelValue:t.componentInfoVisible,"onUpdate:modelValue":o[14]||(o[14]=l=>t.componentInfoVisible=l),title:"组件信息",area:"40%"},{default:m(()=>[ie,e("div",se,[de,e("div",ce,[w(e("input",{type:"text",name:"title","onUpdate:modelValue":o[6]||(o[6]=l=>t.componentInfo.name=l),autocomplete:"off",readonly:"",class:"layui-input",disabled:""},null,512),[[A,t.componentInfo.name]])])]),e("div",ue,[re,e("div",me,[w(e("input",{type:"text",name:"title","onUpdate:modelValue":o[7]||(o[7]=l=>t.componentInfo.describe=l),autocomplete:"off",class:"layui-input",disabled:""},null,512),[[A,t.componentInfo.describe]])])]),e("div",pe,[_e,e("div",fe,[w(e("input",{type:"text",name:"title","onUpdate:modelValue":o[8]||(o[8]=l=>t.componentInfo.typeDesc=l),autocomplete:"off",class:"layui-input",disabled:""},null,512),[[A,t.componentInfo.typeDesc]])])]),t.componentInfo.attributes.length>0?(a(),d("div",ye,[be,e("div",he,[r(B,{columns:t.columns2,"data-source":t.componentInfo.attributes,size:b.md,skin:"line",even:"true"},{name:m(({data:l})=>[g(I(l.name)+" ",1),r(U,{visible:!1,trigger:"hover",content:l.remark,position:"right"},{default:m(()=>[e("div",{onMouseover:o[9]||(o[9]=i=>b.visible=!0),onMouseleave:o[10]||(o[10]=i=>b.visible=!1)},ge,32)]),_:2},1032,["content"])]),_:1},8,["columns","data-source","size"])])])):y("",!0),t.componentInfo.extensionAttributes?(a(),d("div",ke,[xe,e("div",we,[e("div",null,[r(V,{language:"shell",code:t.componentInfo.extensionAttributes},null,8,["code"])])])])):y("",!0),t.componentInfo.script!=null?(a(),d("h3",Ae,"脚本信息")):y("",!0),t.componentInfo.script!=null?(a(),d("div",Ie,[Ve,e("div",Se,[w(e("input",{type:"text",name:"title","onUpdate:modelValue":o[11]||(o[11]=l=>t.componentInfo.scriptName=l),autocomplete:"off",class:"layui-input",disabled:""},null,512),[[A,t.componentInfo.scriptName]])])])):y("",!0),t.componentInfo.script!=null?(a(),d("div",Ne,[e("div",De,[e("div",null,[r(V,{language:t.componentInfo.scriptType,code:t.componentInfo.script},null,8,["language","code"])])])])):y("",!0),t.componentInfo.rollbackScript!=null?(a(),d("div",Ce,[Me,e("div",Ue,[w(e("input",{type:"text",name:"title","onUpdate:modelValue":o[12]||(o[12]=l=>t.componentInfo.rollbackScriptName=l),class:"layui-input",disabled:""},null,512),[[A,t.componentInfo.rollbackScriptName]])])])):y("",!0),t.componentInfo.rollbackScript!=null?(a(),d("div",Be,[e("div",qe,[e("div",null,[e("div",null,[r(V,{language:t.componentInfo.rollbackScriptType,code:t.componentInfo.rollbackScript},null,8,["language","code"])])])])])):y("",!0),Te,t.customData.started!=null?(a(),d("div",je,[We,e("div",Fe,[w(e("input",{type:"text",name:"title","onUpdate:modelValue":o[13]||(o[13]=l=>t.customData.started=l),autocomplete:"off",class:"layui-input",disabled:""},null,512),[[A,t.customData.started]])])])):y("",!0),t.customData&&t.customData.flag!=null?(a(),d("div",He,[ze,e("div",Ee,[(a(!0),d(S,null,C(t.customData,(l,i)=>(a(),d("div",null,[i!=="ex"&&i!=="started"&&i!=="flag"?(a(),d("span",Ge,[e("label",{textContent:I(i)},null,8,Oe),g("："),e("label",{textContent:I(l)},null,8,Qe),Le])):y("",!0)]))),256))])])):y("",!0)]),_:1},8,["modelValue"])],64)}const tt=F(Y,[["render",Re]]);export{tt as default};
